<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin: Manage Excel Files</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_manage_excel.css') }}">
</head>
<body>

<div class="container">
    <header>
        <h1>Manage Excel Files</h1>
        <div class="nav-buttons">
            <button type="button" onclick="window.history.back();" class="btn">Back</button>
            <a href="{{ url_for('admin_home') }}" class="btn">Home</a>
        </div>
    </header>

    <main>
        <!-- Upload Form -->
        <section class="upload-section">
            <h2>Upload Excel File</h2>
            <form method="POST" action="{{ url_for('admin_upload_excel') }}" enctype="multipart/form-data">
                <label class="file-label">
                    Select File:
                    <input type="file" name="excel_file" accept=".xlsx,.xls" required>
                </label>
                <button type="submit" class="btn upload-btn">Upload</button>
            </form>
        </section>

        <!-- Download Section -->
        <section class="download-section">
            <h2>Available Excel Files</h2>
            <ul class="file-list">
                {% for file in excel_files %}
                    <li>
                        <a href="{{ url_for('admin_download_excel', filename=file) }}" class="file-link">
                            {{ file }}
                        </a>
                    </li>
                {% else %}
                    <li>No Excel files found.</li>
                {% endfor %}
            </ul>
        </section>
    </main>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<!-- JS -->
<script src="{{ url_for('static', filename='js/admin_manage_excel.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin_slot_control.js') }}"></script>

<script>
function showToast(message, success = true) {
    const toast = document.getElementById("toast");
    toast.textContent = message;
    toast.className = "toast " + (success ? "success" : "error");
    toast.style.display = "block";

    setTimeout(() => {
        toast.style.display = "none";
    }, 3000);
}

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
    {% for category, message in messages %}
        showToast("{{ message|escape }}", "{{ category }}" === "success");
    {% endfor %}
{% endif %}
{% endwith %}
</script>

</body>
</html>
