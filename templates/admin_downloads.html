{% extends "base.html" %}

{% block title %}Admin â€“ Excel File Management{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto bg-white p-6 rounded shadow mt-6 space-y-8">

    <!-- ================= DOWNLOAD SECTION ================= -->
    <section>
        <h2 class="text-2xl font-bold mb-2">ðŸ“¥ Download Excel Files</h2>
        <p class="text-sm text-gray-500 mb-4">
            Download the latest system data files.
        </p>

        <ul class="space-y-2">
            {% for file in excel_files %}
                <li>
                    <a href="{{ url_for('admin_download', filename=file) }}"
                       class="text-blue-600 hover:underline font-medium">
                        {{ file }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </section>

    <hr class="border-gray-300">

    <!-- ================= UPLOAD SECTION ================= -->
    <section>
        <h2 class="text-2xl font-bold mb-2 text-red-600">âš  Upload & Replace Excel File</h2>
        <p class="text-sm text-gray-500 mb-4">
            Uploading a file will <span class="font-semibold text-red-600">replace the existing system file</span>.
            File name must match exactly.
        </p>

        <form action="{{ url_for('admin_upload') }}"
              method="post"
              enctype="multipart/form-data"
              class="space-y-3">

            <input type="file"
                   name="file"
                   accept=".xlsx"
                   required
                   class="block border rounded p-2 w-full">

            <button type="submit"
                    class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">
                Replace File
            </button>
        </form>
    </section>

    <!-- ================= FLASH MESSAGES ================= -->
    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <ul class="mt-4 text-sm text-blue-600">
            {% for msg in messages %}
                <li>â€¢ {{ msg }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    {% endwith %}

</div>
{% endblock %}
